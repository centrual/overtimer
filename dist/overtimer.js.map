{"version":3,"sources":["../src/overtimer.js"],"names":[],"mappings":"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","file":"overtimer.js","sourcesContent":["/**\n * Overtimer constructor.\n * @param duration {Number} Duration of timer\n * @param opts {Object} Overtimer options\n * @constructor\n */\nfunction Overtimer(duration = 1000, opts = {}) {\n  if (typeof duration !== 'number') {\n    this.log('Duration must be number value.', 1000)\n    duration = 1000\n  } else if (duration <= 0) {\n    this.log('Duration must be bigger than 0.', 1001)\n    duration = 1000\n  } else if (typeof opts !== 'object') {\n    this.log('Options must be object.', 1002)\n    opts = {}\n  }\n  \n  this.eventHandlers = {\n    'start': [],\n    'tick': [],\n    'stop': [],\n    'pause': [],\n    'resume': [],\n    'repeat': [],\n    'finish': [],\n    'update': []\n  }\n  \n  let defaults = {\n    duration,\n    \n    repeat: 1,\n    debug: false,\n    start: true\n  }\n  \n  this.options = Object.assign({}, defaults, opts)\n  \n  // Properties\n  this.version = '0.0.2'\n  this.globalTimerId = null\n  this.state = Overtimer.STATES.CREATED\n  \n  this.createdAt = Date.now()\n  this.startedAt = -1\n  this.repeatedAt = -1\n  this.tickedAt = -1\n  this.stoppedAt = -1\n  this.pausedAt = -1\n  this.resumedAt = -1\n  \n  this.pausedTime = -1\n  this.elapsedTime = -1\n  this.remainingTime = -1\n  this.totalElapsedTime = -1\n  this.totalRemainingTime = -1\n  this.currentRepeat = -1\n  \n  this.timesUpdatedAt = -1\n  \n  if( this.options.start )\n    this.start()\n}\n\n/**\n * Logs errors if debug enabled\n * @param msg {String} Message will be displayed\n * @param code {Number} Code will be displayed\n */\nOvertimer.prototype.log = function( msg = 'Unexcepted error.', code = -1 ) {\n  if( this.options.debug )\n    console.log(`${code !== -1 ? '( ' + code.toString() + ' ): ' : ''} ${msg}`)\n}\n\n/**\n * Registers callback to event.\n * @param eventName {String} Selected event name from available events.\n * @param callback {Function} Function to be triggered when the event occurs.\n * @return {Boolean} true if succeeded, false if not.\n */\nOvertimer.prototype.on = function( eventName, callback ) {\n  if( typeof eventName !== 'string' ) {\n    this.log('Event name must be string.', 1000)\n    return false\n  } else if( eventName.length < 1) {\n    this.log('Event name length be bigger than 0.', 1001)\n    return false\n  } else if( typeof this.eventHandlers[eventName] === 'undefined' ) {\n    this.log('Event name not registered!', 1002)\n    return false\n  } else if( typeof callback !== 'function' ) {\n    this.log('Callback is not function!', 1003)\n    return false\n  }\n  \n  this.eventHandlers[eventName].push(callback)\n  return true\n}\n\n/**\n * Removes all callbacks or spesific function from event\n * @param eventName {String} Selected event name from available events.\n * @param func {Function} Function to be removed.\n * @return {boolean} true if succeeded, false if not.\n */\nOvertimer.prototype.off = function( eventName, func = null ) {\n  if( typeof eventName !== 'string' ) {\n    this.log('Event name must be string.', 1004)\n    return false\n  } else if( eventName.length < 1) {\n    this.log('Event name length be bigger than 0.', 1005)\n    return false\n  } else if( typeof this.eventHandlers[eventName] === 'undefined' ) {\n    this.log('Event name not registered!', 1006)\n    return false\n  }\n  \n  if( typeof func === 'function' )\n    this.eventHandlers[eventName] = this.eventHandlers[eventName].filter( f => f !== func )\n  else\n    this.eventHandlers[eventName] = []\n  \n  return true\n}\n\n/**\n * Triggers registered event\n * @param eventName {string} Event name you want to trigger\n * @param payload {object} payload for trigger. can be array, or can be object\n * @return {boolean} Returns true if succeeded, false if not\n * @private\n */\nOvertimer.prototype.trigger = function(eventName, payload=[]) {\n  if (typeof eventName !== 'string') {\n    this.log('Event name must be string.', 1006)\n    return false\n  } else if (eventName.length < 1) {\n    this.log(\"Event name's length must bigger than 1.\", 1007)\n    return false\n  } else if( typeof this.eventHandlers[eventName.toLowerCase()] === 'undefined' || !Array.isArray(this.eventHandlers[eventName.toLowerCase()]) ) {\n    this.log('Event not found in list.', 1008)\n    return false\n  }\n  \n  if( typeof payload !== 'undefined' && !Array.isArray(payload) ) {\n    payload = [payload]\n  } else if( typeof payload === 'undefined' ) {\n    this.log('Payload comes undefined.', 1009)\n    payload = []\n  }\n  \n  this.eventHandlers[eventName.toLowerCase()].forEach((evt) => {\n    evt.apply(payload)\n  })\n  \n  return true\n}\n\n/**\n * Joins main interval for updates.\n * @private\n */\nOvertimer.prototype.joinToMainInterval = function() {\n  this.globalTimerId = Overtimer.global.join(this.tickMainInterval.bind(this))\n}\n\n/**\n * All time updates happens in this function.\n * @private\n */\nOvertimer.prototype.tickMainInterval = function() {\n  let now = Date.now(),\n    diff = now - this.timesUpdatedAt\n  \n  if( this.state === Overtimer.STATES.RUNNING ) {\n    this.elapsedTime += diff\n    this.remainingTime -= diff\n    this.totalElapsedTime += diff\n    this.totalRemainingTime -= diff\n  } else if( this.state === Overtimer.STATES.PAUSED ) {\n    this.pausedTime += diff\n  }\n  \n  this.timesUpdatedAt = now\n  \n  this.trigger('update')\n  \n  if( this.remainingTime < 1 )\n    this.tick()\n}\n\n/**\n * Leaves from main interval\n * @private\n */\nOvertimer.prototype.leaveFromMainInterval = function() {\n  Overtimer.global.leave(this.globalTimerId)\n  this.globalTimerId = null\n}\n\n/**\n * Starts the timer\n * @return {boolean} true if succeeded, false if not\n */\nOvertimer.prototype.start = function () {\n  if( this.state === Overtimer.STATES.RUNNING ) {\n    this.log('Timer is already started.', 1010)\n    return false\n  }\n  \n  this.state = Overtimer.STATES.RUNNING\n  this.startedAt = Date.now()\n  this.elapsedTime = 0\n  this.totalElapsedTime = 0\n  this.remainingTime = this.options.duration\n  this.totalRemainingTime = this.options.duration * this.options.repeat\n  this.currentRepeat = 1\n\n  this.timesUpdatedAt = Date.now()\n\n  this.joinToMainInterval()\n  this.trigger('start')\n  return true\n}\n\n/**\n * Pauses the timer\n * @return {boolean} true if succeeded, false if not\n */\nOvertimer.prototype.pause = function() {\n  if( this.state !== Overtimer.STATES.RUNNING ) {\n    this.log(\"Can't pause when timer not running.\", 1020)\n    return false\n  }\n  \n  this.state = Overtimer.STATES.PAUSED\n  this.pausedAt = Date.now()\n  \n  return true\n}\n\n/**\n * Resumes the paused timer\n * @return {boolean} true if succeeded, false if not\n */\nOvertimer.prototype.resume = function() {\n  if( this.state !== Overtimer.STATES.PAUSED ) {\n    this.log(\"Can't resume when timer not paused.\", 1021)\n    return false\n  }\n  this.state = Overtimer.STATES.RUNNING\n  this.resumedAt = Date.now()\n  \n  return true\n}\n\n/**\n * Repeats the loop\n * @return {boolean} Returns true if succeeded, false if not\n */\nOvertimer.prototype.repeat = function() {\n  if( this.state !== Overtimer.STATES.RUNNING ) {\n    this.log(\"Can't repeat when timer not running.\", 1012)\n    return false\n  }\n  \n  this.currentRepeat += 1\n  this.elapsedTime = 0\n  this.remainingTime = this.options.duration\n  this.repeatedAt = Date.now()\n  this.totalRemainingTime = ( this.options.repeat * this.options.duration ) - (this.currentRepeat * this.options.duration)\n  \n  this.timesUpdatedAt = Date.now()\n  this.trigger('repeat')\n  return true\n}\n\n/**\n * Works when timer tick time comes.\n */\nOvertimer.prototype.tick = function() {\n  this.tickedAt = Date.now()\n  this.trigger('tick')\n  \n  if( this.currentRepeat < this.options.repeat )\n    this.repeat()\n  else {\n    this.trigger('finish')\n    this.stop()\n  }\n}\n\n/**\n * Stops the timer\n * @return {boolean} Returns true if succeeded, false if not\n */\nOvertimer.prototype.stop = function () {\n  if( this.state === Overtimer.STATES.STOPPED ) {\n    this.log('Timer is already stopped.', 1011)\n    return false\n  }\n  this.leaveFromMainInterval()\n  \n  this.state = Overtimer.STATES.STOPPED\n  this.stoppedAt = Date.now()\n  \n  this.trigger('stop')\n  return true\n}\n\n\n/**\n * Enum for Overtimer states.\n * @type {{CREATED: number, RUNNING: number, PAUSED: number, STOPPED: number}}\n */\nOvertimer.STATES = {\n  CREATED: 0,\n  RUNNING: 1,\n  PAUSED: 2,\n  STOPPED: 3\n}\n\n/**\n * Global timer object for performance.\n */\nOvertimer.global = {\n  callbacks: [],\n  timer: null,\n  updateMs: 1,\n  lastId: 0,\n  \n  /**\n   * Joins the global timer list\n   * @param callback {function} Callback function will trigger ~ every ms\n   * @return {Number} Unique timer id for leave.\n   */\n  join( callback ) {\n    let found = Overtimer.global.callbacks.find( f => f.callback === callback )\n    \n    if( typeof found === 'undefined' ) {\n      Overtimer.global.lastId += 1\n      Overtimer.global.callbacks.push({callback, id: Overtimer.global.lastId})\n    } else {\n      return found.id\n    }\n    \n    if( Overtimer.global.timer === null )\n      Overtimer.global.timer = setInterval(Overtimer.global.tick, Overtimer.global.updateMs)\n    \n    return Overtimer.global.lastId\n  },\n  \n  /**\n   * Leaves from global timer list\n   * @param id {number} Auto generated id from join for leave.\n   */\n  leave( id ) {\n    Overtimer.global.callbacks = Overtimer.global.callbacks.filter(c => c.id !== id)\n    \n    if( Overtimer.global.callbacks.length === 0 && Overtimer.global.timer !== null ) {\n      clearInterval(Overtimer.global.timer)\n      Overtimer.global.timer = null\n    }\n  },\n  \n  /**\n   * Callback trigger function for every ms\n   */\n  tick() {\n    Overtimer.global.callbacks.forEach((cb) => {\n      cb.callback()\n    })\n  }\n}\n\nmodule.exports = Overtimer\n"]}